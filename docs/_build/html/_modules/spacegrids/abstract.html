

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>spacegrids.abstract &mdash; spacegrids  documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="spacegrids  documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">spacegrids  documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for spacegrids.abstract</h1><div class="highlight"><pre>
<span class="c">#encoding:utf-8</span>

<span class="sd">&quot;&quot;&quot; Abstract classes to build Coord, Gr, Ax, AxGr and Field class.</span>

<span class="sd">Most classes inherit from the abstract base classes Named, Associative, Directional, Membered, Valued contained in abstract.py. </span>

<span class="sd">The abstract module contains the following classes:</span>

<span class="sd">Named</span>
<span class="sd">-----</span>

<span class="sd">Base class for most other sg classes, representing objects with copy and same methods.</span>

<span class="sd">Associative</span>
<span class="sd">-----------</span>

<span class="sd">Associative class that objects with the equiv method can belong to. Two objects will be equivalent if they belong to the same associative class. </span>

<span class="sd">Directional</span>
<span class="sd">-----------</span>

<span class="sd">Base class for derived Coord and Ax classes, representing &quot;direction&quot; (e.g. &quot;latitude&quot; or &quot;depth&quot;). An abstract equivalence relationship is defined among Directional objects where two objects are equivalent when they have the same &#39;associative&#39; attribute (pointing to an Associative object). This relationship is generally used to indicate whether two Directional objects have the same direction (e.g. X,Y), but could represent other relationships depending on the user.</span>

<span class="sd">Membered</span>
<span class="sd">--------</span>

<span class="sd">Base class for classes containing members such as a grid (Gr) object containing coordinate (Coord) members, or an AxGr object containing Ax objects, e.g. (X, Y).</span>

<span class="sd">Valued</span>
<span class="sd">------</span>

<span class="sd">Base class for classes that contain a ndarray value attribute. The Field class is derived from this.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">utilsg</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">_config</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">decorators</span> <span class="kn">import</span> <span class="n">check_equiv</span><span class="p">,</span> <span class="n">method2members</span><span class="p">,</span> <span class="n">att2members</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">formatwarning</span> <span class="o">=</span> <span class="n">warning_on_one_line</span>




<span class="c"># ----- most general classes ------------</span>

<div class="viewcode-block" id="Named"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Named">[docs]</a><span class="k">class</span> <span class="nc">Named</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Base class for most other sg classes, representing objects with copy and same methods.</span>

<span class="sd">  The &quot;same&quot; method indicates when Named objects are &quot;the same&quot;, namely when their &quot;name&quot; attribute is the same. This method coincides with the &quot;weaksame&quot; method. &quot;Weaksame&quot; is generally a weaker condition in the derived classes. The &quot;same&quot; method allows the implementation of the &quot;samein&quot; and &quot;sameindex&quot; methods at this abstract level, with generally the &quot;same&quot; method overriden in derived classes.</span>

<span class="sd">  This class provides a copy method that is used by the derived classes.</span>

<span class="sd">  Attributes:</span>
<span class="sd">      name: (str) name of Object</span>
<span class="sd">  &quot;&quot;&quot;</span>



  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;scalar&#39;</span> <span class="p">,</span><span class="n">long_name</span><span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">):</span>  
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialisation of Name object. </span>

<span class="sd">    Args:</span>
<span class="sd">      name: (str) name of Object</span>
<span class="sd">      long_name: (str) longer description (e.g. for display)</span>


<span class="sd">    Returns:</span>
<span class="sd">      Named object</span>
<span class="sd">    &quot;&quot;&quot;</span>
  
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="n">long_name</span>

  <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<div class="viewcode-block" id="Named.copy"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Named.copy">[docs]</a>  <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Copy method for Named. See __init__ for arguments.</span>

<span class="sd">    Most child classes should inherit this method.</span>

<span class="sd">    Returns: </span>
<span class="sd">      a copy of the Directional object.</span>

<span class="sd">    Copy methods in sg work as follows: when no value is selected for an argument, a copy of the self attribute will be used. Otherwise, the **kwargs argument value will be used.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># keys to exclude:    </span>
    <span class="n">forbid</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;self&#39;</span><span class="p">,</span><span class="s">&#39;frame&#39;</span><span class="p">]</span>

    <span class="c"># keys value dict to examine:</span>
    <span class="n">allow</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getargspec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__init__</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forbid</span>  <span class="p">}</span>

    <span class="c"># new kwargs to use in new object .__init__ construction</span>
    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">({})</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">allow</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="c"># if given in kwargs, override</span>
        <span class="n">new_kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c"># otherwise use value in self attribute</span>
        <span class="n">new_kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>  

    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_copy_cleanup</span><span class="p">(</span><span class="o">**</span><span class="n">new_kwargs</span><span class="p">)</span>

    <span class="c"># initialize new object:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="o">**</span><span class="n">new_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</div>
  <span class="k">def</span> <span class="nf">_copy_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">new_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Override this method for specific work to be done before new object init in copy method (e.g. duals in Coord).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">new_kwargs</span>



  <span class="k">def</span> <span class="nf">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Shorthand for weaksame method. See weaksame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">weaksame</span><span class="p">(</span><span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="p">)</span>



<div class="viewcode-block" id="Named.weaksame"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Named.weaksame">[docs]</a>  <span class="k">def</span> <span class="nf">weaksame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests if two Directional objects have the same name.</span>

<span class="sd">    Weak test to see if two Directional objects are similar.</span>

<span class="sd">    Args:</span>
<span class="sd">         other: other Directional object to compare self with</span>
<span class="sd">       </span>
<span class="sd">    Returns: </span>
<span class="sd">         True/ False</span>

<span class="sd">    **See also**</span>
<span class="sd">    same method</span>
<span class="sd">    samein method</span>
<span class="sd">    sameindex method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
      <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="Named.same"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Named.same">[docs]</a>  <span class="k">def</span> <span class="nf">same</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Method to check whether this Named object has identical main attributes to argument other. </span>

<span class="sd">    Placeholder identical to weaksame: to be overriden in child classes.</span>

<span class="sd">    Args:</span>
<span class="sd">      other: (Named) to check against</span>

<span class="sd">    Returns:</span>
<span class="sd">      True/ False</span>

<span class="sd">    Attributes checked:</span>
<span class="sd">      name: via str ==</span>
<span class="sd"> </span>
<span class="sd">    See also:</span>
<span class="sd">      samein method</span>
<span class="sd">      same_index method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">weaksame</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>



</div>
<div class="viewcode-block" id="Named.samein"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Named.samein">[docs]</a>  <span class="k">def</span> <span class="nf">samein</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">L</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tests whether this Directional is the same as any element in list L, under &#39;same&#39; method.</span>

<span class="sd">    Uses: same method.</span>

<span class="sd">    Args:</span>
<span class="sd">      L: (list of Directional objects) to test against</span>

<span class="sd">    returns:</span>
<span class="sd">      True/ False</span>

<span class="sd">    See also:</span>
<span class="sd">      same method</span>
<span class="sd">      same_index method</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">x</span> <span class="ow">or</span> <span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">same</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="Named.sameindex"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Named.sameindex">[docs]</a>  <span class="k">def</span> <span class="nf">sameindex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">L</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Find index of this Directional in list L of Directional objects, under &#39;same&#39; method.</span>

<span class="sd">    Uses: same method.</span>

<span class="sd">    Args:</span>
<span class="sd">      L: (list of directional objects) to search</span>

<span class="sd">    returns:</span>
<span class="sd">      None or Integer, the index of the first item it in the list that satisfies self.same(it)</span>

<span class="sd">    See also:</span>
<span class="sd">      same method</span>
<span class="sd">      samein method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">it</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same</span><span class="p">(</span><span class="n">it</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">i</span>
     
    <span class="k">return</span> <span class="bp">None</span>    
</div>
<div class="viewcode-block" id="Named.json"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Named.json">[docs]</a>  <span class="k">def</span> <span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">types_allow</span> <span class="o">=</span> <span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;convert self to a json friendly object.</span>

<span class="sd">    Usage: json.dumps(X.json())</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c"># class encoding doesn&#39;t work yet:</span>
    <span class="n">return_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;class&#39;</span><span class="p">:</span><span class="nb">str</span><span class="p">(</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="p">)}</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>

      <span class="n">ob_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

      <span class="k">if</span> <span class="n">ob_type</span> <span class="ow">in</span> <span class="n">types_allow</span><span class="p">:</span>
        <span class="c"># this is the nested case on which to call the method recursively</span>

        <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">types_allow</span><span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">types_allow</span> <span class="k">if</span> <span class="n">t</span> <span class="o">!=</span> <span class="n">ob_type</span> <span class="p">]</span> <span class="p">)</span>

      <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="p">):</span>
          <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>

          <span class="n">return_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">return_dict</span>


</div></div>
<div class="viewcode-block" id="Associative"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Associative">[docs]</a><span class="k">class</span> <span class="nc">Associative</span><span class="p">(</span><span class="n">Named</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Associative class that objects with the equiv method can belong to. </span>

<span class="sd">  Two objects will be equivalent if they belong to the same associative class. </span>

<span class="sd">  For Coord objects, this should remain consistent with the axis attribute: two Coord objects belong to the same associative class iff they have the same axis attribute. In this case, the associative class of Coord objects is effectively their direction or axis. The mechanisms for the two remain independent.</span>

<span class="sd">  For classes using Associative as equivalence principle:</span>

<span class="sd">  Their copy method should carry over the Associative object of the parent.</span>
<span class="sd">  Their make_equiv method should make the associate the Associative object of the argument equal to the Associative object of the calling object.</span>
<span class="sd">  Their __init__ method should create a new Associative class as default behaviour, and assign an argument Associative class if given.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">associative</span> <span class="o">=</span> <span class="bp">self</span>

</div>
<div class="viewcode-block" id="Directional"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Directional">[docs]</a><span class="k">class</span> <span class="nc">Directional</span><span class="p">(</span><span class="n">Named</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Base class for derived Coord and Ax classes, representing &quot;direction&quot; (e.g. &quot;latitude&quot; or &quot;depth&quot;).</span>

<span class="sd">  An abstract equivalence relationship is defined among Directional objects where two objects are equivalent when they have the same &#39;associative&#39; attribute (pointing to an Associative object). This relationship is generally used to indicate whether two Directional objects have the same direction (e.g. X,Y), but could represent other relationships depending on the user.</span>

<span class="sd">  The same method is differentiated from the weaksame method (unlike the parent class), with the more strict additional condition that in addition to &quot;name&quot;, the &quot;direction&quot; attribute also needs to be the same. therefore, two Directional objects are considered &quot;same&quot; when both &quot;name&quot; and &quot;direction&quot; match. They are &quot;weaksame&quot; when only the &quot;name&quot; matches.</span>

<span class="sd">  This base class is closely related to the Ax class. The Coord class is also derived from it.</span>


<span class="sd">  Attributes:</span>
<span class="sd">      name: (str) name of Object</span>
<span class="sd">      direction: (str) name of direction in which object points</span>
<span class="sd">      long_name: (str) longer description (e.g. for display or in Netcdf)</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display alias if attribute present, name otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;alias&#39;</span><span class="p">):</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">alias</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;scalar&#39;</span><span class="p">,</span><span class="n">direction</span> <span class="o">=</span><span class="s">&#39;scalar&#39;</span><span class="p">,</span><span class="n">long_name</span><span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">associative</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">):</span>  
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialisation of Directional object. </span>

<span class="sd">    Args:</span>
<span class="sd">      name: (str) name of Object</span>
<span class="sd">      direction: (str) name of direction in which object points</span>
<span class="sd">      long_name: (str) longer description (e.g. for display or in Netcdf)</span>
<span class="sd">      associative: (Directional or Associative) object that this new object is equivalent to, or its Associative</span>

<span class="sd">    Returns:</span>
<span class="sd">      Directional object</span>

<span class="sd">    Raises:</span>
<span class="sd">      ValueError if associative has no associative attribute</span>
<span class="sd">    &quot;&quot;&quot;</span>
  
<span class="c"># choosing the name ID creates an identity object. ID*b = b for all Coord elements b.</span>
<span class="c"># could implement the identity Field in __call__</span>

<span class="c"># Metric could be a class. Objects of this class could be constructed by a method of the Coord class (Coord objects then spawn metric objects).</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">equivs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="n">long_name</span>

    <span class="k">if</span> <span class="n">associative</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">associative</span> <span class="o">=</span> <span class="n">Associative</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s">&#39;_assoc&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">associative</span><span class="p">,</span> <span class="s">&#39;associative&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">associative</span> <span class="o">=</span> <span class="n">associative</span><span class="o">.</span><span class="n">associative</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;provide object with associative attribute for associative.&#39;</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    To be overriden for now. Could introduce +-1 here.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>

<div class="viewcode-block" id="Directional.same"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Directional.same">[docs]</a>  <span class="k">def</span> <span class="nf">same</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Method to check whether this Directional object has identical main attributes to argument other. </span>

<span class="sd">    Overrides Name class same method.    </span>

<span class="sd">    Args:</span>
<span class="sd">      other: (Directional) to check against</span>

<span class="sd">    Returns:</span>
<span class="sd">      True/ False</span>

<span class="sd">    Attributes checked:</span>
<span class="sd">      name: via str ==</span>
<span class="sd">      direction: via str == </span>

<span class="sd">    See also:</span>
<span class="sd">      samein method</span>
<span class="sd">      same_index method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>




<span class="c"># ----- equivalence related ---------  </span>
</div>
<div class="viewcode-block" id="Directional.make_equiv"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Directional.make_equiv">[docs]</a>  <span class="k">def</span> <span class="nf">make_equiv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register equivalence of two Directional objects. </span>

<span class="sd">    Args:</span>
<span class="sd">      other: (Directional)</span>

<span class="sd">    Returns:</span>
<span class="sd">      None</span>

<span class="sd">    See also:</span>
<span class="sd">      is_equiv</span>
<span class="sd">      eq_index</span>
<span class="sd">      eq_in</span>

<span class="sd">    Examples:</span>
<span class="sd">    &gt;&gt;&gt; depth.is_equiv(longitude) # generally different directions.</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; depth.make_equiv(longitude) # don&#39;t do this in real work</span>
<span class="sd">    &gt;&gt;&gt; depth.is_equiv(longitude) # uphysically:</span>
<span class="sd">    True </span>
<span class="sd">    &quot;&quot;&quot;</span>  

    <span class="n">other</span><span class="o">.</span><span class="n">associative</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">associative</span>  

    <span class="k">return</span>

</div>
<div class="viewcode-block" id="Directional.is_equiv"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Directional.is_equiv">[docs]</a>  <span class="k">def</span> <span class="nf">is_equiv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span> <span class="n">checks</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test for equivalence (under make_equiv) between Directional objects. e.g. xt is equivalent to xu</span>

<span class="sd">    Args:</span>
<span class="sd">      other: (Coord or Ax)</span>

<span class="sd">    Returns:</span>
<span class="sd">      True when equivalent, False otherwise.</span>

<span class="sd">    Examples:</span>
<span class="sd">    &gt;&gt;&gt; depth.is_equiv(longitude) # generally different directions.</span>
<span class="sd">    False</span>

<span class="sd">    See also:</span>
<span class="sd">      make_equiv</span>
<span class="sd">      eq_index</span>
<span class="sd">      eq_in</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<span class="c">#    if (other in self.equivs) | (self in other.equivs):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">associative</span> <span class="ow">is</span> <span class="n">other</span><span class="o">.</span><span class="n">associative</span><span class="p">:</span> 

      <span class="k">return</span> <span class="bp">True</span>     
    <span class="k">else</span><span class="p">:</span>
      <span class="c"># Warnings helpful for debugging and spotting potential problems:</span>

      <span class="k">if</span> <span class="n">checks</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>
          <span class="k">if</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">same</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;Warning (severe): </span><span class="si">%s</span><span class="s">.is_equiv(</span><span class="si">%s</span><span class="s">) is False, but </span><span class="si">%s</span><span class="s">.same(</span><span class="si">%s</span><span class="s">) is True! &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">)</span> <span class="p">)</span>
          <span class="k">elif</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">weaksame</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;Warning (severe): </span><span class="si">%s</span><span class="s">.is_equiv(</span><span class="si">%s</span><span class="s">) is False, but </span><span class="si">%s</span><span class="s">.weaksame(</span><span class="si">%s</span><span class="s">) is True! &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> 
          <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;Consistency check failed.&#39;</span><span class="p">)</span>

      <span class="c"># then go about normal business:</span>
      <span class="k">return</span> <span class="bp">False</span>


</div>
<div class="viewcode-block" id="Directional.eq_index"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Directional.eq_index">[docs]</a>  <span class="k">def</span> <span class="nf">eq_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Find index of first element in collection equivalent to self under is_equiv.</span>

<span class="sd">    Args:</span>
<span class="sd">      collection: (e.g. List) order collection of Directional objects</span>

<span class="sd">    Returns:</span>
<span class="sd">      Integer if equivalent found (index to equiv element), None otherwise.</span>


<span class="sd">    See also:</span>
<span class="sd">      make_equiv</span>
<span class="sd">      is_equiv</span>
<span class="sd">      eq_in</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">collection</span><span class="p">):</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_equiv</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">i</span>
    <span class="k">return</span> 

</div>
<div class="viewcode-block" id="Directional.eq_in"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Directional.eq_in">[docs]</a>  <span class="k">def</span> <span class="nf">eq_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collection</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Determines whether Coord (self) is equivalent to any of the constituent Coord objects of the argument Gr or GrAx, and returns equivalent object.</span>

<span class="sd">    Uses: eq_index</span>

<span class="sd">    Args:</span>
<span class="sd">      collection: (Gr or AxGr) object to be checked.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The equivalent object  when crd is equivalent to one of the Coord objects in argument, None otherwise.</span>

<span class="sd">    See also:</span>
<span class="sd">      eq_in method of Ax, GrAx</span>
<span class="sd">      is_equiv</span>
<span class="sd">      make_equiv</span>
<span class="sd">      eq_index</span>
<span class="sd">      eq_in   </span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eq_index</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">collection</span><span class="p">[</span><span class="n">i</span> <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>   
      <span class="k">return</span>




<span class="c"># Belongs to Directional</span>
</div>
  <span class="k">def</span> <span class="nf">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand calling make_equiv (to register equivalence with other Directional object). </span>

<span class="sd">    Args:</span>
<span class="sd">      other: (Directional)</span>

<span class="sd">    Returns:</span>
<span class="sd">      None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">make_equiv</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand calling is_equiv (to test equivalence with other Directional object). </span>

<span class="sd">    Args:</span>
<span class="sd">      other: (Directional)</span>

<span class="sd">    Returns:</span>
<span class="sd">      None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_equiv</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>





<span class="c"># ----- multiplication related ---------      </span>

  <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Repeated multiplication of object with itself.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="Membered"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered">[docs]</a><span class="k">class</span> <span class="nc">Membered</span><span class="p">(</span><span class="n">Named</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Base class for classes containing members such as a grid (Gr) object containing coordinate (Coord) members, or an AxGr object containing Ax objects, e.g. (X, Y).</span>

<span class="sd">  This class is intended for multiple inheritance with classes that provide container functionality. For example Tuple. The elements inside the tuples are then referred to as &quot;members&quot;, hence the name of this class.  Methods relate to general operations with these members. Note that more specific member-related methods are relegated to derived classes.</span>

<span class="sd">  __init__ method of joint-inheritance class must take a container of elements. </span>
<span class="sd">  &quot;&quot;&quot;</span>


<div class="viewcode-block" id="Membered.same"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.same">[docs]</a>  <span class="k">def</span> <span class="nf">same</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Member-wise same comparison.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">same</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">):</span>    
          <span class="k">return</span> <span class="bp">False</span>

      <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">False</span>


</div>
<div class="viewcode-block" id="Membered.weaksame"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.weaksame">[docs]</a>  <span class="k">def</span> <span class="nf">weaksame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Member-wise weaksame comparison.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">weaksame</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">):</span>    
          <span class="k">return</span> <span class="bp">False</span>

      <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="Membered.call_on_members"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.call_on_members">[docs]</a>  <span class="k">def</span> <span class="nf">call_on_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Call method on all members and construct new Membered object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span> <span class="p">[</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">method</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">]</span> <span class="p">)</span>

</div>
<div class="viewcode-block" id="Membered.get_from_members"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.get_from_members">[docs]</a>  <span class="k">def</span> <span class="nf">get_from_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">att_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Call method on all members and construct new Membered object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span> <span class="p">[</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">att_name</span><span class="p">)</span> <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span> <span class="p">]</span> <span class="p">)</span>

</div>
  <span class="k">def</span> <span class="nf">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand to member-wise weaksame comparison.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">weaksame</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

  <span class="nd">@method2members</span>
  <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="c">#    &quot;&quot;&quot;</span>
<span class="c">#    Call __neg__ on members and return corresponding Membered object.</span>
<span class="c">#    &quot;&quot;&quot;</span>
<span class="c">#    return self.__class__( [-member for member in self] )</span>

<div class="viewcode-block" id="Membered.reverse"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.reverse">[docs]</a>  <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reverse the order of the members.</span>

<span class="sd">    Examples:</span>

<span class="sd">    &gt;&gt;&gt; coord1 = sg.fieldcls.Coord(name = &#39;test1&#39;,direction =&#39;X&#39;,value =np.array([1.,2.,3.]) )</span>
<span class="sd">    &gt;&gt;&gt; coord2 = sg.fieldcls.Coord(name = &#39;test2&#39;,direction =&#39;Y&#39;,value =np.array([1.,2.,3.,4.]) )</span>
<span class="sd">    &gt;&gt;&gt; (coord1*coord2).reverse()</span>
<span class="sd">    (test2, test1)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">([</span> <span class="bp">self</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="mi">1</span> <span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>  <span class="p">])</span>

</div>
  <span class="nd">@method2members</span>
<div class="viewcode-block" id="Membered.copy"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.copy">[docs]</a>  <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Member-wise copy method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="Membered.strict_equiv"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.strict_equiv">[docs]</a>  <span class="k">def</span> <span class="nf">strict_equiv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests whether two Membered objects have equivalent Members at each position.</span>
<span class="sd">    This is a stricter test than Membered equivalence testing via gr1.is_equiv(gr2), which only tests whether both Membered objects describe the same linear space (elements equivalent up to a permutation).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
      
      <span class="n">RO</span> <span class="o">=</span> <span class="bp">True</span>      
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">it</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">RO</span> <span class="o">*=</span> <span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">is_equiv</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
      <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">RO</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">False</span>

</div>
  <span class="k">def</span> <span class="nf">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for is_equiv.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
      
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_equiv</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>


<div class="viewcode-block" id="Membered.is_equiv"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.is_equiv">[docs]</a>  <span class="k">def</span> <span class="nf">is_equiv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks member-wise equivalence between Membered objects up to a permutation. </span>

<span class="sd">    For grids,  objects are equivalent if they define the same physical subspace, based on the equivalence definition for Coord classes. In other words, checks whether the individual Coord elements of the two grid (Gr object) arguments are equivalent up to a permutation. A stricter version of this test is strict_equiv, which allows no permutation.</span>
<span class="sd"> </span>
<span class="sd">    Args:</span>
<span class="sd">      other: (Membered) the object to compare with</span>

<span class="sd">    Returns:</span>
<span class="sd">      True if all (self) members are equivalent to a member of other and vice versa and both have equal length. False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
      
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eq_perm</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
      <span class="k">return</span> <span class="bp">False</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">False</span>


</div>
<div class="viewcode-block" id="Membered.eq_in"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.eq_in">[docs]</a>  <span class="k">def</span> <span class="nf">eq_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Determines whether argument is equivalent to any of the constituent members.</span>

<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">      member: (Membered) object to be checked.</span>

<span class="sd">    Returns:</span>
<span class="sd">      True when member is equivalent to one of the member objects, False otherwise.</span>

<span class="sd">    See also:</span>
<span class="sd">    eq_in method of Coord </span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">member</span><span class="o">.</span><span class="n">is_equiv</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>
</div>
<div class="viewcode-block" id="Membered.eq_index"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.eq_index">[docs]</a>  <span class="k">def</span> <span class="nf">eq_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">member</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns index of argument in members.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">member</span><span class="o">.</span><span class="n">is_equiv</span><span class="p">(</span><span class="n">v</span><span class="p">):</span> <span class="k">return</span> <span class="n">i</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</div>
<div class="viewcode-block" id="Membered.rearrange"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.rearrange">[docs]</a>  <span class="k">def</span> <span class="nf">rearrange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">permutation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rearranges the order of the members of this object via permutation arrgument. </span>

<span class="sd">    Args:</span>
<span class="sd">      permutation: (List or Tuple) permutation to rearrange by</span>

<span class="sd">    Returns:</span>
<span class="sd">      object of same type as self with member rearranged.</span>
<span class="sd">  </span>
<span class="sd">    Examples: </span>

<span class="sd">    &gt;&gt;&gt; g1 = latitude*depth</span>
<span class="sd">    &gt;&gt;&gt; g1.rearrange( (1,0) ) </span>
<span class="sd">    (depth, latitude)</span>

<span class="sd">    See also Gr.perm method    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">((</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">permutation</span><span class="p">))</span>
    
    

</div>
<div class="viewcode-block" id="Membered.perm"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.perm">[docs]</a>  <span class="k">def</span> <span class="nf">perm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>     
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    yields permutation of axes going from self to other.</span>

<span class="sd">    E.g. for grids gr1 and gr2, g2 = g1.rearrange( g1.perm(g2) )</span>

<span class="sd">    Returns None if no permutation exists.</span>

<span class="sd">    See also rearrange.</span>
<span class="sd">    &quot;&quot;&quot;</span>  

    <span class="k">return</span> <span class="n">find_perm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Membered.eq_perm"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.eq_perm">[docs]</a>  <span class="k">def</span> <span class="nf">eq_perm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>      
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Yields permutation of members going from self to other, where equivalent members are treated as identical. </span>

<span class="sd">    See also perm.</span>
<span class="sd">    &quot;&quot;&quot;</span>  

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
      <span class="n">perm</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">other</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eq_in</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
          <span class="n">perm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eq_index</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span> <span class="s">&#39;Warning from eq_perm (often benign): inputs not permutable, returning None.&#39;</span><span class="p">)</span>
          <span class="k">return</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;Message from eq_perm: inputs must be of equal length.&quot;</span>
      <span class="k">return</span> 
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>




</div>
<div class="viewcode-block" id="Membered.json"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Membered.json">[docs]</a>  <span class="k">def</span> <span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">types_allow</span> <span class="o">=</span> <span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;convert self to a json friendly object.</span>

<span class="sd">    Usage: json.dumps(X.json())</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">members</span> <span class="o">=</span> <span class="p">[</span><span class="n">member</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">types_allow</span><span class="o">=</span><span class="n">types_allow</span><span class="p">)</span> <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>

    <span class="n">return_members</span>

</div></div>
<div class="viewcode-block" id="Valued"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Valued">[docs]</a><span class="k">class</span> <span class="nc">Valued</span><span class="p">(</span><span class="n">Named</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Base class for classes that contain a ndarray value attribute. </span>

<span class="sd">  This class derives its name from the presence of an attribute named &quot;value&quot; that contains a Numpy ndarray. Methods relate to this attribute.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;scalar&#39;</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span><span class="n">long_name</span> <span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>  

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialisation of Valued object. </span>

<span class="sd">    Args:</span>
<span class="sd">      name: (str) name of object.</span>
<span class="sd">      value: (Numpy ndarray) </span>
<span class="sd">      long_name: (str) a longer description. </span>
<span class="sd">    &quot;&quot;&quot;</span>
  
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="n">long_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">shape</span>


  <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display alias if attribute present, name otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;alias&#39;</span><span class="p">):</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">alias</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>


<div class="viewcode-block" id="Valued.get_value"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Valued.get_value">[docs]</a>  <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="Valued.set_value"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Valued.set_value">[docs]</a>  <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

</div>
  <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Obtain item from value atttribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="Valued.sliced"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Valued.sliced">[docs]</a>  <span class="k">def</span> <span class="nf">sliced</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">slice_obj</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">,</span><span class="n">suffix</span> <span class="o">=</span> <span class="s">&#39;_sliced&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create new sliced Valued object with sliced value.</span>

<span class="sd">    The slice argument must match the value dimensions, there are no checks.</span>

<span class="sd">    Args:</span>
<span class="sd">      slice_obj: (slice objects or tuple of) to slice value with</span>
<span class="sd">      suffix: (str) suffix to use for sliced Valued object</span>

<span class="sd">    Returns:</span>
<span class="sd">      Valued object containing sliced value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">affix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">suffix</span><span class="p">)</span> <span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">slice_obj</span><span class="p">]</span>  <span class="p">)</span>
</div>
<div class="viewcode-block" id="Valued.array_equal"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Valued.array_equal">[docs]</a>  <span class="k">def</span> <span class="nf">array_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; test whether Valued objects contain identically valued ndarrays in value attributes.</span>

<span class="sd">    This is a common method that should be inherited by child classes. </span>

<span class="sd">    Args:</span>
<span class="sd">      other: (Valued object) the Valued to compare with</span>

<span class="sd">    Returns:</span>
<span class="sd">      True/ False (using np.array_equal)</span>

<span class="sd">    Raises:</span>
<span class="sd">      ValueError: when argument is not a Coord object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="n">Valued</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Error: provide Valued argument (</span><span class="si">%s</span><span class="s"> provided).&#39;</span><span class="o">%</span><span class="n">other</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> 

</div>
<div class="viewcode-block" id="Valued.same"><a class="viewcode-back" href="../../spacegrids.html#spacegrids.abstract.Valued.same">[docs]</a>  <span class="k">def</span> <span class="nf">same</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests whether this Valued object contains identical name and value to argument object. </span>

<span class="sd">    Overrides Named same method and is a stronger condition. Generally to be overriden in child classes.</span>

<span class="sd">    Args:</span>
<span class="sd">      other: (Valued) object to compare against.</span>

<span class="sd">    Returns: </span>
<span class="sd">      True/ False</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># the following test and warning is to do with little things that we don&#39;t want to trip over with errors:</span>
    <span class="c"># self is a Coord, so it has a value attribute (this should be put into the specs!), but other might not:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">):</span>
      <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;Valued method </span><span class="si">%s</span><span class="s">.same(</span><span class="si">%s</span><span class="s">) on argument without Ax attribute: returning False.&#39;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>      
      <span class="k">return</span> <span class="bp">False</span>

    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> 


</div>
  <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtain version of Valued with negative values (e.g. -xt). </span>

<span class="sd">    Returns:</span>
<span class="sd">      Valued copy with value is -self.value</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">value</span> <span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>



  <span class="k">def</span> <span class="nf">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Repeated multiplication of object with itself.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="p">])</span>

  <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Addition of value attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Substraction of value attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>


  <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Multiplication of value attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">*</span><span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Division of value attributes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">spacegrids  documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Willem Sijp.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>